# NO MORE than 1 task per file, NO MORE / NO LESS than 6-8 subtasks per task
id: "001"
task: "Accelerate scanning and cleaning pipeline"
entry: "2024-04-21T00:00:00Z"
modified: "2024-04-21T00:00:00Z"
priority: "H"
project: "mc"
status: "todo"
uuid: "performance_refactor_v1"
urgency: "7"
subtasks: # REMEMBER: no more than 6-8
  - desc: "Capture baseline timings with cargo run -- --dry-run on representative repos"
    agent: "core-dev"
  - desc: "Stream WalkDir entries via rayon::par_bridge and remove DashMap fan-in"
    agent: "core-dev"
  - desc: "Accumulate directory byte sizes during initial traversal to avoid rewalks"
    agent: "core-dev"
  - desc: "Thread DirEntry file_type metadata into PatternMatcher to skip redundant stats"
    agent: "core-dev"
  - desc: "Refactor prune_nested_items to use linear prefix tracking instead of O(n^2)"
    agent: "core-dev"
  - desc: "Reuse a shared Rayon pool in ParallelCleaner and adopt finer par_iter workload"
    agent: "core-dev"
  - desc: "Add regression benchmarks and document tuning knobs in docs/TECHNICAL_SPEC.md"
    agent: "core-dev"
must_reference: # include but not limited to:
  [
    "docs/ARCHITECTURE.md",
    "docs/TECHNICAL_SPEC.md",
    "src/engine/scanner.rs",
    "src/engine/cleaner.rs",
  ]
